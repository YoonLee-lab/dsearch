#!/usr/bin/env bash
# Create menu based on URLs and titles.

readonly datadir=${XDG_DATA_HOME:-$HOME/local/share}

# Main

#[[ ! $result ]] && exit 0

main() {
	n=$(echo '{ "command": ["get_property", "playlist-count"] }' | socat - /tmp/mpvsocket | jshon -e data)

	for (( i = 0; i < n; i++ )); do
  		URL=$(echo '{ "command": ["get_property_string", "playlist/'$i'/title"] }' | socat - /tmp/mpvsocket | jshon -e data -u)
	done
}

result=$(main | dmenu -p "Select video: ")

echo '{ "command": ["set_property", "playlist-pos", '${result%%\ *}'] }' | socat - /tmp/mpvsock, 
